<!doctype html><html><head><title>Serverless Machine Learning Module 0</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link rel=stylesheet href=/css/flag-icon.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600"><link rel=stylesheet href=/fontawesome/css/all.min.css><meta property="og:title" content="Serverless Machine Learning Module 0"><meta property="og:description" content="Following along with the serverless-ml online course by Jim Dowling and Hopsworks."><meta property="og:type" content="article"><meta property="og:url" content="https://BenSnow6.github.io/posts/serverlessml/lab-modules/lab-0/"><meta property="article:published_time" content="2022-10-05T08:06:25+06:00"><meta property="article:modified_time" content="2022-10-05T08:06:25+06:00"><meta name=description content="Following along with the serverless-ml online course by Jim Dowling and Hopsworks."><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><link rel=stylesheet href=/css/style.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/>Ben Snow's Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><a href=/posts/introduction/ title=Introduction>Introduction</a></li><li><a href=/posts/restructuring/ title=Restructuring>Restructuring</a></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/serverlessml/>Serverless ML</a><ul class=active><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/serverlessml/lab-modules/>Lab Modules</a><ul class=active><li><a class=active href=/posts/serverlessml/lab-modules/lab-0/ title="Lab 0">Lab 0</a></li><li><i class="fas fa-plus-circle"></i><a href=/posts/serverlessml/lab-modules/lab-1/>Lab 1</a><ul><li><a href=/posts/serverlessml/lab-modules/lab-1/end-to-end-pipeline/ title="End to End">End to End</a></li></ul></li></ul></li><li><a href=/posts/serverlessml/lectures/ title=Lectures>Lectures</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://BenSnow6.github.io/posts/serverlessml/lab-modules/lab-0/hero.png)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/avatar_hub7979d5c0b641038ae587dc7f4e229bf_336111_120x120_fit_q75_box.jpg alt="Author Image"><h5 class=author-name>Ben Snow</h5><p>:date_full</p></div><div class=title><h1>Serverless Machine Learning Module 0</h1></div><div class=post-content id=post-content><p>05/10/2022</p><h2 id=intro>Intro</h2><p>We&rsquo;re looking at lab 0 of the <a href=https://www.serverless-ml.org/>Serverless-ML course</a> today. Make sure to check out their website and their <a href=https://github.com/featurestoreorg/serverless-ml-course>Github repository and give them a star!</a></p><p>A link to my fork of the repo is <a href=https://github.com/BenSnow6/serverless-ml-course/tree/main/src/00-intro>here</a> if you wish to follow along with my notebooks!</p><p>This course aims to allow a data scientist to deploy machine learning and predictive services online without the use of a server. This is useful in creating powerful business applications to show the predictive capabilities of a machine learning model quickly and effectively.</p><h2 id=labs>Labs</h2><h3 id=pandas>Pandas</h3><p>We started with a simple pandas introduction lab involving converting to datetime from a given date field. After, we looked at applying functions to a series within the dataframe with a few different methods. We used lambda functions to create a new column based on an amount being greater than a specified value. We also used the <code>.apply</code> function to apply a user defined function to a series. Along with this, rolling windows were introduced to compute the highest value over a given time period, in this case, the highest amount spent in the past day.
Additionally, we looked at how vectorized operations are much (around 50x) faster than <code>.apply</code> functions when operating on dataframes. And example of a vectorized function is</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>df[<span style=color:#e6db74>&#39;a&#39;</span>] <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span> <span style=color:#75715e># raise all values in series &#39;a&#39; to the power of two</span>
</code></pre></div><p>Finally we looked at applying power transformations to a near exponentially distributed dataset to convert it to a near gaussian distribution, therefore making it more suitable for deep learning. In the notebook I wrote that &lsquo;We wish for distributions that are more Gaussian for machine learning algorithms since they operate on the assumption that the distributions are smoothly varying, are differentiable, and have the possibility for infinite surprise.&rsquo;</p><h3 id=apples-and-oranges>Apples and oranges</h3><p>In these two notebooks, we create a simple decision tree classifier and a Logistic regression model to predict the label of apples and oranges based on their red-green colour touples. We found that the logistic regression model performed well but mis-classified one of the test examples hinting at overfitting and poor generalisation of the model. This was attributed to an out of sample test feature being used. See the notebook re-and-green-apples-vs-oranges.ipynb for more details.</p><h3 id=feature-store-intro>Feature store intro</h3><p>In this notebook, we set up a Hopsworks account online and began by creating an API key with which we can access the Hopsworks online platform.</p><p>Motivation for using Hopsworks is to create feature stores, online databases that store artefacts useful for training and inference with machine learning models. We wish to create a feature group that is a table of features that are written to the feature store as a dataframe.</p><p>Feature groups require a name and are usually provided with a version, description, primary key, and event time. We defined a feature group as follows:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>fg <span style=color:#f92672>=</span> fs<span style=color:#f92672>.</span>get_or_create_feature_group(
     name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;credit_card_transactions&#34;</span>,
     version<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
     description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Credit Card Transaction data&#34;</span>,
     primary_key<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;credit_card_number&#39;</span>],
     event_time<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;trans_datetime&#39;</span>
)
</code></pre></div><p>This particular use case is creating features for a credit card fraud detection model.</p><p>Features can be written to the feature group by inserting a dataframe:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>fg<span style=color:#f92672>.</span>insert(df) <span style=color:#75715e># adds the dataframe to the feature group with a hopsworks job</span>
</code></pre></div><p>We can see the online feature group<a href=https://c.app.hopsworks.ai/p/2289/fs/2234/fg/2883> here</a> which also includes plenty of metadata about the group.</p><h4 id=reading-from-the-feature-store>Reading from the feature store</h4><p>We can query the feature group by selecting columns within the dataset and using the <code>fg.select(['column1, column2'])</code> function.
Additionally, a feature view can be made with the returned selection query which allows for model inference (not training). We can define which of the columns are selected as features (query) and which of the columns is the label:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>query <span style=color:#f92672>=</span> fg<span style=color:#f92672>.</span>select([<span style=color:#e6db74>&#34;amount&#34;</span>, <span style=color:#e6db74>&#34;location&#34;</span>, <span style=color:#e6db74>&#34;fraud&#34;</span>])

fv <span style=color:#f92672>=</span> fs<span style=color:#f92672>.</span>create_feature_view(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;credit_card_transactions&#34;</span>,
                            version<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
                            description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Features from the credit_card_transactions FG&#34;</span>,
                            labels<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#34;fraud&#34;</span>],
                            query<span style=color:#f92672>=</span>query)
</code></pre></div><p>Again, we can see this online at Hopsworks <a href=https://c.app.hopsworks.ai:443/p/2289/fs/2234/fv/credit_card_transactions/version/1>here</a></p><h4 id=using-feature-views>Using feature views</h4><p>We can use a feature view to set training and test features and labels like we would a dataframe. Hopsworks has its own train test split function that we can apply to a feature view to return this split.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>X_train, X_test, y_train, y_test <span style=color:#f92672>=</span> fv<span style=color:#f92672>.</span>train_test_split(<span style=color:#ae81ff>0.5</span>)
</code></pre></div><p>I love when it&rsquo;s so simple!</p><p>We can also save some of the training data to disk if we wish and then use these to read in during training. This can be done by writing the feature view data to a .csv file. Very useful for large datasets.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>td_version, td_job <span style=color:#f92672>=</span> fv<span style=color:#f92672>.</span>create_train_test_split(
    description <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Transactions fraud batch training dataset&#39;</span>,
    data_format <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;csv&#39;</span>, <span style=color:#75715e># file format</span>
    test_size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>, <span style=color:#75715e># 50% tr/te split</span>
    write_options <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;wait_for_job&#39;</span>: True}, <span style=color:#75715e># waits for the job to finish</span>
    coalesce <span style=color:#f92672>=</span> True, <span style=color:#75715e># save the dataframe into a single partition before writing</span>
)
</code></pre></div><p><code>td_version</code> here is the version of the training data for the feature view and <code>td_job</code> can be used to follow the jo progress. A little popup to follow the job link is outputted during execution and the link to the job <a href=https://c.app.hopsworks.ai/p/2289/jobs/named/credit_card_transactions_1_1_create_fv_td_05102022114302/executions>can be seen here</a> .</p><p>This train test split can then be seen on the Hopsworks website under Project Settings -> File Browser -> projectname_Training_Datasets.
Super easy!</p><p>We can then grab the x_train, y_train, x_test, y_test from the feature view with the dataset version we want:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>X_train, y_train, X_test, y_test <span style=color:#f92672>=</span> fv<span style=color:#f92672>.</span>get_train_test_split(td_version)
</code></pre></div><p>Note we pass <code>td_version</code> here that was generated above.</p><h4 id=aggregating-data>Aggregating data</h4><p>We now will do a little feature engineering. We will start with some aggregations of data within the training dataset. One of these aggregations is to sum up all the amounts spent by the same credit card and save that in a new column called &ldquo;total spent&rdquo;. Then we can add when this total is calculated to.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># group and sum</span>
df <span style=color:#f92672>=</span> df[[<span style=color:#e6db74>&#34;credit_card_number&#34;</span>, <span style=color:#e6db74>&#34;amount&#34;</span>]]<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#34;credit_card_number&#34;</span>)<span style=color:#f92672>.</span>sum()
<span style=color:#75715e># rename col to total spent</span>
df<span style=color:#f92672>.</span>rename(columns<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#34;amount&#34;</span>: <span style=color:#e6db74>&#34;total_spent&#34;</span>}, inplace<span style=color:#f92672>=</span>True)
<span style=color:#75715e># set a new column storing the date up to the amounts were summed over</span>
df[<span style=color:#e6db74>&#34;as_of_datetime&#34;</span>] <span style=color:#f92672>=</span> df[[<span style=color:#e6db74>&#34;credit_card_number&#34;</span>, <span style=color:#e6db74>&#34;trans_datetime&#34;</span>]]<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#34;credit_card_number&#34;</span>)<span style=color:#f92672>.</span>max()
<span style=color:#75715e># Move credit card number to be a column since it is currently the index</span>
df<span style=color:#f92672>.</span>reset_index(inplace<span style=color:#f92672>=</span>True)
</code></pre></div><p>Now a new feature group can be created holding this new dataset with new features!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>fg2 <span style=color:#f92672>=</span> fs<span style=color:#f92672>.</span>get_or_create_feature_group(
     name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;credit_card_spending&#34;</span>,
     version<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
     description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Credit Card Spending&#34;</span>,
     primary_key<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;credit_card_number&#39;</span>],
     event_time<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;as_of_datetime&#39;</span> <span style=color:#75715e># new event time is based on the sum until date</span>
)
</code></pre></div><p>This can then be inserted to the feature group:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>fg2<span style=color:#f92672>.</span>insert(df, write_options<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#34;wait_for_job&#34;</span>: False})
</code></pre></div><p>We can now add more data to the original feature group and insert it into the feature group.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>more_data <span style=color:#f92672>=</span> {

    <span style=color:#e6db74>&#39;credit_card_number&#39;</span>: [<span style=color:#e6db74>&#39;9999 8888 7777 6666&#39;</span>, <span style=color:#e6db74>&#39;9999 8888 7777 6666&#39;</span>,<span style=color:#e6db74>&#39;9999 8888 7777 6666&#39;</span>, <span style=color:#e6db74>&#39;9999 8888 7777 6666&#39;</span>],
    <span style=color:#e6db74>&#39;trans_datetime&#39;</span>: [<span style=color:#e6db74>&#39;2022-01-02 04:11&#39;</span>, <span style=color:#e6db74>&#39;2022-01-03 07:24&#39;</span>, <span style=color:#e6db74>&#39;2022-01-05 10:33&#39;</span>, <span style=color:#e6db74>&#39;2022-01-05 11:50&#39;</span>],
    <span style=color:#e6db74>&#39;amount&#39;</span>: [<span style=color:#ae81ff>55.67</span>, <span style=color:#ae81ff>84</span>, <span style=color:#ae81ff>77.95</span>, <span style=color:#ae81ff>183</span>],
    <span style=color:#e6db74>&#39;location&#39;</span>: [<span style=color:#e6db74>&#39;San Francisco&#39;</span>, <span style=color:#e6db74>&#39;San Francisco&#39;</span>, <span style=color:#e6db74>&#39;Dublin&#39;</span>, <span style=color:#e6db74>&#39;Dublin&#39;</span>],
    <span style=color:#e6db74>&#39;fraud&#39;</span>: [False, False, False, False]
}
<span style=color:#75715e># create df from dictionary</span>
df3 <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame<span style=color:#f92672>.</span>from_dict(more_data)
<span style=color:#75715e># apply date time transformation</span>
df3[<span style=color:#e6db74>&#39;trans_datetime&#39;</span>]<span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>to_datetime(df3[<span style=color:#e6db74>&#39;trans_datetime&#39;</span>])
<span style=color:#75715e># grab the feature group from the feature store</span>
fg <span style=color:#f92672>=</span> fs<span style=color:#f92672>.</span>get_feature_group(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;credit_card_transactions&#34;</span>, version<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)  
<span style=color:#75715e># insert the new data to the feature group</span>
fg<span style=color:#f92672>.</span>insert(df3, write_options<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#34;wait_for_job&#34;</span>: False})
</code></pre></div><p>We can now see the newly added feature group entries on <a href=https://c.app.hopsworks.ai/p/2289/fs/2234/fg/2883/data-preview>Hopsworks</a> (reminder, only I can see these, you&rsquo;ll need to create a Hopsworks account and follow the tutorial to see your own feature groups).</p><h4 id=time-series-window-aggregations>Time series window aggregations</h4><p>We now use some windowing techniques to count how much money was spent per day (window length = &lsquo;1d&rsquo;). We need the <code>event_time</code> column as the index so start by reading the feature group to a df:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>df <span style=color:#f92672>=</span> fg<span style=color:#f92672>.</span>read() <span style=color:#75715e># read feature group</span>
df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>set_index(<span style=color:#e6db74>&#39;trans_datetime&#39;</span>) <span style=color:#75715e># set index to event_time</span>
df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>sort_index() <span style=color:#75715e># sorts the index based on the times</span>
</code></pre></div><p>Now we calculate some rolling window features, the max amount in the past day and the mean amount in the past day:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>df[<span style=color:#e6db74>&#39;rolling_max_1d&#39;</span>] <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>rolling(<span style=color:#e6db74>&#39;1d&#39;</span>)<span style=color:#f92672>.</span>amount<span style=color:#f92672>.</span>max() <span style=color:#75715e># max past day</span>
df[<span style=color:#e6db74>&#39;rolling_mean_1d&#39;</span>] <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>rolling(<span style=color:#e6db74>&#39;1d&#39;</span>)<span style=color:#f92672>.</span>amount<span style=color:#f92672>.</span>mean() <span style=color:#75715e># mean past day</span>
</code></pre></div><p>Then we reset the index (since doing these sorts of operations sets the <code>event_time</code> to be the index) and create a new feature group and insert the new data to it.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>fg_agg <span style=color:#f92672>=</span> fs<span style=color:#f92672>.</span>get_or_create_feature_group(
     name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;credit_card_rolling_windows&#34;</span>,
     version<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
     description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Daily Credit Card Spending&#34;</span>,
     primary_key<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;credit_card_number&#39;</span>],
     event_time<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;trans_datetime&#39;</span> <span style=color:#75715e># remember to set the event_time back to trans_dt</span>
)
</code></pre></div><p>We&rsquo;ve successfully created three feature groups, each with their own sets of features in them that we can read from whenever we want! (<code>fg = fs.get_feature_group(name="", version=x</code>).</p><h4 id=feature-view-with-features-from-multiple-feature-groups>Feature view with features from multiple feature groups!</h4><p>Ok, let&rsquo;s suppose we want to grab features from lots of different feature groups and use them to train a model, how do we do that? Well it&rsquo;s quite easy, we just use a query to select the features from one feature group that we wish to use (<code>fg.select_all()</code> for example that selects all features from <code>fg</code>) and join that to the selection from another feature group (<code>fg_agg.select(['rolling_max_1d'])</code> taking only the <code>rolling_max_1d</code> feature from the <code>fg_agg</code> feature group).</p><p>We can see an example of something like this here:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># create query</span>
query <span style=color:#f92672>=</span> fg<span style=color:#f92672>.</span>select_all()<span style=color:#f92672>.</span>join(fg_agg<span style=color:#f92672>.</span>select([<span style=color:#e6db74>&#39;rolling_max_1d&#39;</span>, <span style=color:#e6db74>&#39;rolling_mean_1d&#39;</span>]))
<span style=color:#75715e># read data from query</span>
training_data <span style=color:#f92672>=</span> query<span style=color:#f92672>.</span>read()
</code></pre></div><p>We can now create a feature view containing the data from this query:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>fv <span style=color:#f92672>=</span> fs<span style=color:#f92672>.</span>create_feature_view(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;credit_card_fraud_rolling&#34;</span>,
                            description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Features for a model to predict credit card fraud, including rolling windows&#34;</span>,
                            version<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
                            query<span style=color:#f92672>=</span>query)
</code></pre></div><p>Check out the feature view <a href=https://c.app.hopsworks.ai:443/p/2289/fs/2234/fv/credit_card_fraud_rolling/version/1>here on Hopsworks</a> . What&rsquo;s great is that there are links in the feature view to take you to the exact feature group where the feature columns (or labels) have come from!
We can use this feature view to create a test train split of the data:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>X_train, y_train, X_test, y_test <span style=color:#f92672>=</span> fv<span style=color:#f92672>.</span>train_test_split(<span style=color:#ae81ff>0.5</span>)
</code></pre></div><p>Don&rsquo;t forget we can grab all the data from a feature group and read it into a dataframe shown below:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># specify which feature group to read</span>
fg <span style=color:#f92672>=</span> fs<span style=color:#f92672>.</span>get_feature_group(name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;credit_card_transactions&#34;</span>, version<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
<span style=color:#75715e># read it to a df</span>
read_df <span style=color:#f92672>=</span> fg<span style=color:#f92672>.</span>read()
</code></pre></div><h4 id=filtering>Filtering</h4><p>We can also grab only specific parts of the dataset by reading with a query (filtering). For example, we can read only the data with amounts greater than 100:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> hsfs.feature <span style=color:#f92672>import</span> Feature
<span style=color:#75715e># only grab features from the fg with amount &gt;100</span>
big_amounts_df <span style=color:#f92672>=</span> fg<span style=color:#f92672>.</span>filter(Feature(<span style=color:#e6db74>&#34;amount&#34;</span>) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>100</span>)<span style=color:#f92672>.</span>read()
</code></pre></div><h2 id=summary>Summary</h2><p>In these labs, we revised some elementary pandas techniques, fit logistic and decision tree models to simple classification problems, and investigated the use of feature stores on the Hopsworks ecosystem!</p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/BenSnow6/BenSnow6.github.io/edit/main/content/posts/ServerlessML/Lab%20Modules/Lab%200/index.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/restructuring/ title="Restructuring a project" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i>Prev</div><div class=next-prev-text>Restructuring a project</div></a></div><div class="col-md-6 next-article"><a href=/posts/serverlessml/lab-modules/lab-1/end-to-end-pipeline/ title="End to end pipeline" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>End to end pipeline</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#intro>Intro</a></li><li><a href=#labs>Labs</a><ul><li><a href=#pandas>Pandas</a></li><li><a href=#apples-and-oranges>Apples and oranges</a></li><li><a href=#feature-store-intro>Feature store intro</a><ul><li><a href=#reading-from-the-feature-store>Reading from the feature store</a></li><li><a href=#using-feature-views>Using feature views</a></li><li><a href=#aggregating-data>Aggregating data</a></li><li><a href=#time-series-window-aggregations>Time series window aggregations</a></li><li><a href=#feature-view-with-features-from-multiple-feature-groups>Feature view with features from multiple feature groups!</a></li><li><a href=#filtering>Filtering</a></li></ul></li></ul></li><li><a href=#summary>Summary</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://BenSnow6.github.io#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://BenSnow6.github.io#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://BenSnow6.github.io#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://BenSnow6.github.io#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://BenSnow6.github.io#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://BenSnow6.github.io#recent-posts>Recent Posts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:bensnows@gmail.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span><span>bensnows@gmail.com</span></a></li><li><span><i class="fas fa-phone-alt"></i></span><span>+44 7794748089</span></li></ul></div><div class="col-md-4 col-sm-12"><p>Stay up to date with email notification</p><form method=post action=https://blogtrottr.com><div class=form-group><input type=email class=form-control name=btr_email placeholder="Enter email"><br><input type=hidden name=btr_url value=https://BenSnow6.github.ioindex.xml>
<input type=hidden name=schedule_type value=1>
<small id=emailHelp class="form-text text-muted">By entering your email address, you agree to receive the newsletter of this website.</small>
<button type=submit class="btn btn-info"> Submit</button></div></form></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_2.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2022 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script><script type=text/javascript src=/js/popper.min.js></script><script type=text/javascript src=/js/bootstrap.min.js></script><script type=text/javascript src=/js/navbar.js></script><script type=text/javascript src=/js/plyr.js></script><script type=text/javascript src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/js/single.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>